import{d as k,r as T,u as C,c as t,f as F,_ as S,a as g,w as o,o as c,V as f,b as x,e as w,t as R,g as D}from"./index.js";import{m as $,c as B,V as N,a as h,b as V,d as U,e as q}from"./VTextField.js";const z=k({name:"VForm",props:{...$()},emits:{"update:modelValue":e=>!0,submit:e=>!0},setup(e,a){let{slots:u,emit:p}=a;const d=B(e),l=T();function s(i){i.preventDefault(),d.reset()}function b(i){const r=i,n=d.validate();r.then=n.then.bind(n),r.catch=n.catch.bind(n),r.finally=n.finally.bind(n),p("submit",r),r.defaultPrevented||n.then(y=>{let{valid:v}=y;if(v){var m;(m=l.value)==null||m.submit()}}),r.preventDefault()}return C(()=>{var i;return t("form",{ref:l,class:"v-form",novalidate:!0,onReset:s,onSubmit:b},[(i=u.default)==null?void 0:i.call(u,d)])}),F(d,l)}}),A={name:"Login",data:()=>({loading:!1,login:"",password:"",passwordVisible:!1,notify:!1,notificationText:""}),methods:{async onSubmit(){await this.$refs.loginForm.validate().then(a=>a.valid)&&(this.loading=!0,await this.authorize({login:this.login,password:this.password}).then(a=>{a.ok?this.$router.push({name:"default"}):(this.notify=!0,this.notificationText=a.error)}).catch(a=>{this.notify=!0,this.notificationText=a.error}).finally(()=>{this.loading=!1}))},async authorize(e){return await this.$axios.postForm("/",e).then(a=>{if(console.log("responseDataAxios",a.data),!a.data)throw new Error(a.statusText);return{ok:!0,...a}}).catch(a=>(console.log("errorAxios",a),{status:a.response.status,ok:!1,error:a.message,code:a.code}))}},computed:{passwordInputType(){return this.passwordVisible?"text":"password"},rules(){return{login:[e=>!!e||"\u041F\u043E\u043B\u0435 \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F",e=>e.length>=3||"\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u0430\u044F \u0434\u043B\u0438\u043D\u0430 3 \u0441\u0438\u043C\u0432\u043E\u043B\u0430"],password:[e=>!!e||"\u041F\u043E\u043B\u0435 \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F",e=>e.length>=5||"\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u0430\u044F \u0434\u043B\u0438\u043D\u0430 5 \u0441\u0438\u043C\u0432\u043E\u043B\u043E\u0432"]}}}},I=w(" \u0412\u043E\u0439\u0442\u0438 ");function L(e,a,u,p,d,l){return c(),g(N,{class:"enter pa-md-5 pa-sm-2 pa-xs-2 pa-lg-10 pa-xl-10 login-card",loading:e.loading,rounded:""},{default:o(()=>[t(z,{class:"login-form",ref:"loginForm"},{default:o(()=>[t(f,null,{default:o(()=>[t(h,null,{default:o(()=>[t(V,{modelValue:e.login,"onUpdate:modelValue":a[0]||(a[0]=s=>e.login=s),required:"",loading:e.loading,type:"text",label:"\u041B\u043E\u0433\u0438\u043D",placeholder:"\u041B\u043E\u0433\u0438\u043D",clearable:"","prepend-icon":"mdi-account",rules:l.rules.login},null,8,["modelValue","loading","rules"])]),_:1})]),_:1}),t(f,null,{default:o(()=>[t(h,null,{default:o(()=>[t(V,{modelValue:e.password,"onUpdate:modelValue":a[1]||(a[1]=s=>e.password=s),label:"\u041F\u0430\u0440\u043E\u043B\u044C",required:"",loading:e.loading,placeholder:"\u041F\u0430\u0440\u043E\u043B\u044C",type:l.passwordInputType,"prepend-icon":"mdi-lock","append-icon":"mdi-eye","onClick:append":a[2]||(a[2]=s=>e.passwordVisible=!e.passwordVisible),rules:l.rules.password},null,8,["modelValue","loading","type","rules"])]),_:1})]),_:1}),t(f,null,{default:o(()=>[t(x,{class:"mb-5",onClick:l.onSubmit,loading:e.loading,width:"100%",height:"70"},{default:o(()=>[I]),_:1},8,["onClick","loading"])]),_:1}),t(U)]),_:1},512),e.notify?(c(),g(q,{key:0,modelValue:e.notify,"onUpdate:modelValue":a[3]||(a[3]=s=>e.notify=s)},{default:o(()=>[w(R(e.notificationText),1)]),_:1},8,["modelValue"])):D("",!0)]),_:1},8,["loading"])}const j=S(A,[["render",L]]);export{j as default};
