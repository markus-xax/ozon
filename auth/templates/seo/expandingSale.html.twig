{% extends 'index/index.html.twig' %}
{% block linkStyles %}
    <link href="../../../styles/index/styles.css" rel="stylesheet">
    <link href="../../../styles/index/vendor.css" rel="stylesheet">
    <link href="../../../styles/summary/summary.css" rel="stylesheet">
    <link href="../../../styles/summary/table.css" rel="stylesheet">
    <link href="../../../styles/summary/table2.css" rel="stylesheet">

{% endblock %}
{% block body %}
    <div id="mp-stats-app" class="main-content container-fluid">
        <div id="global-loader-block" aria-hidden="true" class="mp-loader-overlay ag-overlay hidden">
            <div class="ag-overlay-panel">
                <div class="ag-overlay-wrapper ag-layout-normal ag-overlay-loading-wrapper">
                    <div class="mp-loader-static"></div>
                </div>
            </div>
        </div>
        <div data-v-0ead128c="" id="app-layout">
            <div data-v-99ed1cd6="" data-v-0ead128c="">
                <div data-v-99ed1cd6="" class="card mb-2 card-top">
                    <div data-v-99ed1cd6=""
                         class="card-header d-md-flex align-items-start justify-content-between pb-2 pt-3">
                        <div data-v-99ed1cd6="">Расширение запросов: товарные позиции</div> <!---->
                        <div data-v-99ed1cd6="" class="d-flex justify-content-between">
                            <div data-v-99ed1cd6="" class="d-block-inline dropdown-period mr-2"><!----><!----><!---->
                                <!---->
                                <div class="btn-group d-flex flex-column flex-lg-block flex-lg-row">
                                    <div class="dropdown b-dropdown btn-group" id="__BVID__489"><!---->
                                        <button aria-haspopup="true" aria-expanded="false" type="button"
                                                class="btn btn-secondary" id="__BVID__489__BV_toggle_">
                                            Период
                                        </button>
                                    </div> <!---->
                                    <div class="btn btn-secondary active">
                                        <div data-v-1ebd09d2="" class="vue-daterange-picker">
                                            <div data-v-1ebd09d2="" class=""><i data-v-1ebd09d2=""
                                                                                class="glyphicon glyphicon-calendar fa fa-calendar"></i>
                                                <span data-v-1ebd09d2="">15.04.2022 - 14.05.2022</span><b
                                                        data-v-1ebd09d2="" class="caret"></b></div><!----></div>
                                    </div> <!----></div>
                            </div>
                            <button data-v-99ed1cd6="" class="btn btn-info mr-2">
                                <svg data-v-99ed1cd6="" viewBox="0 0 16 16" width="1em" height="1em" focusable="false"
                                     role="img" aria-label="stop circle" xmlns="http://www.w3.org/2000/svg"
                                     fill="currentColor" class="bi-stop-circle mr-1 b-icon bi">
                                    <g data-v-99ed1cd6="">
                                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"></path>
                                        <path d="M5 6.5A1.5 1.5 0 0 1 6.5 5h3A1.5 1.5 0 0 1 11 6.5v3A1.5 1.5 0 0 1 9.5 11h-3A1.5 1.5 0 0 1 5 9.5v-3z"></path>
                                    </g>
                                </svg>
                                Стоп слова <span data-v-99ed1cd6="" class="badge badge-light">0</span></button>
                            <button data-v-99ed1cd6="" class="btn btn-success">
                                <svg data-v-99ed1cd6="" viewBox="0 0 16 16" width="1em" height="1em" focusable="false"
                                     role="img" aria-label="file text" xmlns="http://www.w3.org/2000/svg"
                                     fill="currentColor" class="bi-file-text mr-1 b-icon bi">
                                    <g data-v-99ed1cd6="">
                                        <path d="M5 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1H5zm-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5zM5 8a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1H5zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1H5z"></path>
                                        <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1z"></path>
                                    </g>
                                </svg>
                                Новый запрос
                            </button>
                        </div>
                    </div> <!---->
                    <div data-v-99ed1cd6="" class="card-body pt-0 pb-0">
                        <div data-v-99ed1cd6="" class="tabs" id="__BVID__500"><!---->
                            <div class="">
                                <ul role="tablist" class="nav nav-tabs" id="__BVID__500__BV_tab_controls_"><!---->
                                    <li role="presentation" class="nav-item"><a
                                                id="__BVID__501___BV_tab_button__">{{ path[0].sku??'' }}</a>
                                    </li><!----></ul>
                            </div>
                            <div class="tab-content mt-3" id="__BVID__500__BV_tab_container_">
                                <div data-v-99ed1cd6="" role="tabpanel" aria-hidden="false" class="tab-pane active"
                                     style="" id="__BVID__501" aria-labelledby="__BVID__501___BV_tab_button__">
                                    <div data-v-99ed1cd6="" class="d-flex justify-content-between align-items-end">
                                        <div data-v-99ed1cd6="" class="media"><img data-v-99ed1cd6=""
                                                                                   referrerpolicy="no-referrer"
                                                                                   src="{{ img.t??'' }}"
                                                                                   id="preview" class="mr-3"> <!---->
                                            <div data-v-99ed1cd6="" class="media-body">
                                                <table data-v-99ed1cd6="" class="table table-sm">
                                                    <tbody data-v-99ed1cd6="">
                                                    <tr data-v-99ed1cd6="">
                                                        <td data-v-99ed1cd6="">Название</td>
                                                        <td data-v-99ed1cd6="">{{ path[0].name??'Не найдено' }}</td>
                                                    </tr>
                                                    <tr data-v-99ed1cd6="">
                                                        <td data-v-99ed1cd6="">Продавец</td>
                                                        <td data-v-99ed1cd6=""><a>{{ path[0].seller??'' }}</a></td>
                                                    </tr>
                                                    <tr data-v-99ed1cd6="">
                                                        <td data-v-99ed1cd6="">Бренд</td>
                                                        <td data-v-99ed1cd6=""><a>{{ path[0].brand??'' }}</a></td>
                                                    </tr>
                                                    <tr data-v-99ed1cd6="">
                                                        <td data-v-99ed1cd6="">SKU</td>
                                                        <td data-v-99ed1cd6="">{{ path[0].sku??'' }}</td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div data-v-99ed1cd6="" class="pb-2"><a data-v-99ed1cd6="" target="_blank"
                                                                                referrerpolicy="no-referrer"
                                                                                href="https://www.wildberries.ru/catalog/{{ path[0].sku??'' }}/detail.aspx"
                                                                                class="btn btn-sm font-weight-light mr-3">
                                                Открыть в WB <i data-v-99ed1cd6="" class="fa fa-external-link-alt"></i></a>
                                            <a data-v-99ed1cd6="" target="_blank" href="/wb/item/{{ path[0].sku??'' }}"
                                               class="btn btn-sm font-weight-light">
                                                Открыть в MpStats
                                            </a></div>
                                    </div>
                                </div><!----></div>
                        </div>
                    </div>
                </div> <!----><!----><!----> <!---->
                <div data-v-99ed1cd6="" class="card"><!----><!---->
                    <div data-v-99ed1cd6="" class="tabs" id="__BVID__503"><!---->
                        <div class="">
                            <ul role="tablist" class="nav nav-tabs" id="__BVID__503__BV_tab_controls_"><!---->
                                <li class="nav-item">
                                    <a onclick="change(this, 0)" class="nav-link active" id="change0">Запросы</a>
                                </li>
                                <li role="presentation" class="nav-item">
                                    <a onclick="change(this, 1)" class="nav-link" id="change1">Слова</a>
                                </li>
                            </ul>
                        </div>
                        <div class="tab-content" id="__BVID__503__BV_tab_container_">
                            <div data-v-99ed1cd6="" role="tabpanel" aria-hidden="false" class="tab-pane active"
                                 id="tab-pane0" aria-labelledby="__BVID__504___BV_tab_button__">
                                <div data-v-99ed1cd6="" class="ag-height-65">
                                    <div tooltip-show-delay="200" groupdisplaytype="singleColumn"
                                         class="ag-theme-material">
                                    </div>
                                </div>
                                <div data-v-99ed1cd6="" class="d-flex justify-content-between mt-3">
                                    <div data-v-99ed1cd6="">Всего:</div>
                                    <div data-v-99ed1cd6="">
                                        <button onclick="option.api.exportDataAsCsv()" data-v-99ed1cd6=""
                                                class="btn btn-outline-secondary font-weight-light">
                                            <svg data-v-99ed1cd6="" viewBox="0 0 16 16" width="1em" height="1em"
                                                 focusable="false" role="img" aria-label="file excel"
                                                 xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                                 class="bi-file-excel b-icon bi">
                                                <g data-v-99ed1cd6="">
                                                    <path d="M5.18 4.616a.5.5 0 0 1 .704.064L8 7.219l2.116-2.54a.5.5 0 1 1 .768.641L8.651 8l2.233 2.68a.5.5 0 0 1-.768.64L8 8.781l-2.116 2.54a.5.5 0 0 1-.768-.641L7.349 8 5.116 5.32a.5.5 0 0 1 .064-.704z"></path>
                                                    <path d="M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H4zm0 1h8a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z"></path>
                                                </g>
                                            </svg>
                                            Экспорт в CSV
                                        </button>
                                        <button onclick="option.api.exportDataAsExcel()" data-v-99ed1cd6=""
                                                class="btn btn-outline-secondary font-weight-light">
                                            <svg data-v-99ed1cd6="" viewBox="0 0 16 16" width="1em" height="1em"
                                                 focusable="false" role="img" aria-label="file earmark excel"
                                                 xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                                 class="bi-file-earmark-excel b-icon bi">
                                                <g data-v-99ed1cd6="">
                                                    <path d="M5.884 6.68a.5.5 0 1 0-.768.64L7.349 10l-2.233 2.68a.5.5 0 0 0 .768.64L8 10.781l2.116 2.54a.5.5 0 0 0 .768-.641L8.651 10l2.233-2.68a.5.5 0 0 0-.768-.64L8 9.219l-2.116-2.54z"></path>
                                                    <path d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5v2z"></path>
                                                </g>
                                            </svg>
                                            Экспорт в XLSX
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div data-v-99ed1cd6="" role="tabpanel" aria-hidden="true" class="tab-pane"
                                 style="display: none;" id="tab-pane1"
                                 aria-labelledby="__BVID__508___BV_tab_button__">
                                <div data-v-99ed1cd6="" class="ag-height-65">
                                    <div tooltip-show-delay="200" groupdisplaytype="singleColumn"
                                         class="ag-theme-material">

                                    </div>
                                </div>
                                <div data-v-99ed1cd6="" class="d-flex justify-content-between mt-3">
                                    <div data-v-99ed1cd6="">Всего: 37</div>
                                    <div data-v-99ed1cd6="" class="d-flex align-items-center">
                                        <div data-v-99ed1cd6="" class="form-check-inline"><input data-v-99ed1cd6=""
                                                                                                 type="checkbox"
                                                                                                 id="keywords"
                                                                                                 class="form-check-input">
                                            <label data-v-99ed1cd6="" for="keywords" class="form-check-label">
                                                Включить в экспорт "Ключевые фразы"
                                            </label></div>
                                        <button onclick="option2.api.exportDataAsCsv()" data-v-99ed1cd6=""
                                                class="btn btn-outline-secondary font-weight-light mr-1">
                                            <svg data-v-99ed1cd6="" viewBox="0 0 16 16" width="1em" height="1em"
                                                 focusable="false" role="img" aria-label="file excel"
                                                 xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                                 class="bi-file-excel b-icon bi">
                                                <g data-v-99ed1cd6="">
                                                    <path d="M5.18 4.616a.5.5 0 0 1 .704.064L8 7.219l2.116-2.54a.5.5 0 1 1 .768.641L8.651 8l2.233 2.68a.5.5 0 0 1-.768.64L8 8.781l-2.116 2.54a.5.5 0 0 1-.768-.641L7.349 8 5.116 5.32a.5.5 0 0 1 .064-.704z"></path>
                                                    <path d="M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H4zm0 1h8a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z"></path>
                                                </g>
                                            </svg>
                                            Экспорт в CSV
                                        </button>
                                        <button onclick="option2.api.exportDataAsExcel()" data-v-99ed1cd6=""
                                                class="btn btn-outline-secondary font-weight-light">
                                            <svg data-v-99ed1cd6="" viewBox="0 0 16 16" width="1em" height="1em"
                                                 focusable="false" role="img" aria-label="file earmark excel"
                                                 xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                                 class="bi-file-earmark-excel b-icon bi">
                                                <g data-v-99ed1cd6="">
                                                    <path d="M5.884 6.68a.5.5 0 1 0-.768.64L7.349 10l-2.233 2.68a.5.5 0 0 0 .768.64L8 10.781l2.116 2.54a.5.5 0 0 0 .768-.641L8.651 10l2.233-2.68a.5.5 0 0 0-.768-.64L8 9.219l-2.116-2.54z"></path>
                                                    <path d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5v2z"></path>
                                                </g>
                                            </svg>
                                            Экспорт в XLSX
                                        </button>
                                    </div>
                                </div>
                            </div><!----></div>
                    </div><!----><!----></div> <!----> <!----></div>
        </div>
        <div><!---->
            <div class="snotify snotify-leftTop"></div>
            <div class="snotify snotify-leftCenter"></div>
            <div class="snotify snotify-leftBottom"></div>
            <div class="snotify snotify-rightTop"></div>
            <div class="snotify snotify-rightCenter"></div>
            <div class="snotify snotify-rightBottom"></div>
            <div class="snotify snotify-centerTop"></div>
            <div class="snotify snotify-centerCenter"></div>
            <div class="snotify snotify-centerBottom"></div>
        </div>
    </div>
    <script>
        function change(element, l) {
            for (i = 0; i < 2; i++) {
                document.getElementById("change" + i).classList.remove("active")
                document.getElementById("tab-pane" + i).style.display = "none"
            }
            element.classList.add("active")
            document.getElementById("tab-pane" + l).style.display = "block"
        }

        let option = {}, option2 = {}
        document.addEventListener('DOMContentLoaded', () => {
            option = {...getOptions()};
            option2 = {...getOptions()};
            option['columnDefs'] = [
                {
                    headerName: '',
                    field: 'search',
                    maxWidth: 80,
                    filter: false,
                    sortable: false,
                    cellRenderer: params => `<span> <button class="btn btn-sm"> <svg viewBox="0 0 16 16" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi-trash b-icon bi"> <g> <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"> </path> <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4L4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"> </path> </g> </svg> </button> </span>`
                },
                {
                    headerName: 'Запросы',
                    field: 'word',
                    minWidth: 1500,
                    cellRenderer: params => `<a href="https://wildberries.ru/catalog/0/search.aspx?search=${params.value}&amp;xsearch=true"class="mr-1"><svg viewBox="0 0 16 16" width="1em" height="1em" focusable="false" role="img" aria-label="search" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi-search b-icon bi"> <g> <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"></path> </g> </svg> </a> <a href="/seo/keyword/${params.value}"><span>${params.value}</span></a>`
                },
                {
                    headerName: 'Частота',
                    field: 'count',
                    minWidth: 150,
                },
            ];
            option['rowData'] = [
                {% if words is defined %}
                {% if words|length > 0 %}
                {% for res in words %}
                {
                    word: '{{ res.word }}',
                    search: '',
                    count: '{{ res.count }}'
                },
                {% endfor %}
                {% endif %}
                {% endif %}
            ]
            option['rowHeight'] = 70
            new agGrid.Grid(document.getElementsByClassName("ag-theme-material")[0], option)

            option2['columnDefs'] = [
                {
                    headerName: '',
                    field: 'search',
                    maxWidth: 80,
                    filter: false,
                    sortable: false,
                    cellRenderer: params => `<div class="ag-cell ag-cell-not-inline-editing ag-cell-auto-height d-flex align-items-center justify-content-center ag-cell-value" aria-selected="false" style="width: 65px; left: 0px;  "> <span><button class="btn btn-sm"><svg viewBox="0 0 16 16" width="1em" height="1em" focusable="false" role="img" aria-label="trash" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi-trash b-icon bi"><g><path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"></path><path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4L4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"></path></g></svg></button></span> </div>`
                },
                {
                    headerName: 'Слово',
                    field: 'word',
                    minWidth: 300,
                },
                {
                    headerName: 'Словоформы',
                    field: 'words',
                    minWidth: 1250,
                },
                {
                    headerName: 'Кол-во вхождений',
                    field: 'count',
                    maxWidth: 150,
                },
                {
                    headerName: 'Сумм. частотность',
                    field: 'keys_count_sum',
                    maxWidth: 150,
                },
            ]
            option2['rowData'] = [
                {% if result is defined %}
                {% if result|length > 0 %}
                {% for res in result %}
                {
                    search: '',
                    word: '{{ res.word }}',
                    words: '{{ res.words|join(', ') }}',
                    count: '{{ res.count }}',
                    keys_count_sum: '{{ res.keys_count_sum }}'
                },
                {% endfor %}
                {% endif %}
                {% endif %}
            ]
            option2['rowHeight'] = 70
            new agGrid.Grid(document.getElementsByClassName("ag-theme-material")[1], option2)
        })
    </script>
{% endblock %}