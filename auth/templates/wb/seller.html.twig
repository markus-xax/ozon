{% extends 'index/index.html.twig' %}
{% block linkStyles %}
    <link href="../../styles/index/styles.css" rel="stylesheet">
    <link href="../../styles/index/vendor.css" rel="stylesheet">
    <link href="../../styles/summary/summary.css" rel="stylesheet">
    <link href="../../styles/summary/table.css" rel="stylesheet">
    <link href="../../styles/summary/table2.css" rel="stylesheet">
    <link href="../../styles/seo/selection.css" rel="stylesheet">
    <link href="../../styles/seo/slider.css" rel="stylesheet">
    <link href="../../styles/seo/table.css" rel="stylesheet">

{% endblock %}
{% block body %}
    <div id="mp-stats-app" class="main-content container-fluid">
        <div id="global-loader-block" aria-hidden="true" class="mp-loader-overlay ag-overlay hidden">
            <div class="ag-overlay-panel">
                <div class="ag-overlay-wrapper ag-layout-normal ag-overlay-loading-wrapper">
                    <div class="mp-loader-static"></div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12 col-12">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-start">
                        <div class="d-flex flex-column">
                            <div class="d-flex justify-content-start">

                                Сводка по продавцу <b class="ml-1">{{ sku }}</b>
                                <div class="ml-2">
                                </div>
                            </div>
                            <div><a target="_blank" class="mp-green-link"></a></div>
                        </div>
                        <div class="d-flex justify-content-between align-items-center ml-5">
                            <div class="d-flex align-items-center"><i class="fa fa-info-circle mr-2"></i>
                                <div data-v-0b49be3c="" class="d-inline-block text-left mr-1 switcher-xs">
                                    <div data-v-0b49be3c="" class="switcher-button-wrapper">
                                        <div data-v-0b49be3c=""
                                             class="switch-button mr-1 switch-button-xs switcher-fbs"><input
                                                    data-v-0b49be3c="" type="checkbox" name="switcher-element-22404"
                                                    id="switcher-element-22404"> <span data-v-0b49be3c=""><label
                                                        data-v-0b49be3c="" for="switcher-element-22404"></label></span>
                                        </div>
                                        <span data-v-0b49be3c="" class="switcher-text"></span></div>
                                </div>
                            </div>

                            <div class="d-block-inline dropdown-period"><!----><!----><!----><!----><!----><!---->
                                <!---->
                                <div class="btn-group d-flex flex-column flex-lg-block flex-lg-row">
                                    <div class="dropdown b-dropdown btn-group" id="__BVID__26"><!---->
                                        <button aria-haspopup="menu" aria-expanded="false" type="button"
                                                class="btn btn-secondary" id="__BVID__26__BV_toggle_">
                                            Период
                                        </button>
                                    </div> <!---->
                                    <div class="btn btn-secondary active">
                                        <div data-v-1ebd09d2="" class="vue-daterange-picker">
                                            <input disabled value="{{d1}} to {{d2}}" id="datePicker" type="text"><!----></div>
                                    </div> <!----></div>
                            </div>
                        </div>
                    </div>
                    <div class="tabs" id="__BVID__39"><!---->
                        <div class="">
                            <ul role="tablist" class="nav nav-tabs" id="__BVID__39__BV_tab_controls_"><!---->
                                <li role="presentation" class="nav-item"><a role="tab" aria-selected="true"
                                                                            aria-setsize="9" aria-posinset="1" href="#"
                                                                            target="_self" class="nav-link active"
                                                                            id="__BVID__40___BV_tab_button__"
                                                                            aria-controls="__BVID__40">Товары</a></li>
                                <li role="presentation" class="nav-item"><a role="tab" tabindex="-1"
                                                                            aria-selected="false" aria-setsize="9"
                                                                            aria-posinset="2" href="#" target="_self"
                                                                            class="nav-link"
                                                                            id="__BVID__46___BV_tab_button__"
                                                                            aria-controls="__BVID__46">Категории</a>
                                </li>
                                <li role="presentation" class="nav-item"><a role="tab" tabindex="-1"
                                                                            aria-selected="false" aria-setsize="9"
                                                                            aria-posinset="3" href="#" target="_self"
                                                                            class="nav-link"
                                                                            id="__BVID__48___BV_tab_button__"
                                                                            aria-controls="__BVID__48">Бренды</a></li>
                                <li role="presentation" class="nav-item"><a role="tab" tabindex="-1"
                                                                            aria-selected="false" aria-setsize="9"
                                                                            aria-posinset="4" href="#" target="_self"
                                                                            class="nav-link"
                                                                            id="__BVID__50___BV_tab_button__"
                                                                            aria-controls="__BVID__50">Тренд</a></li>
                                <li role="presentation" class="nav-item"><a role="tab" tabindex="-1"
                                                                            aria-selected="false" aria-setsize="9"
                                                                            aria-posinset="5" href="#" target="_self"
                                                                            class="nav-link"
                                                                            id="__BVID__52___BV_tab_button__"
                                                                            aria-controls="__BVID__52">По дням</a></li>
                                <li role="presentation" class="nav-item"><a role="tab" tabindex="-1"
                                                                            aria-selected="false" aria-setsize="9"
                                                                            aria-posinset="6" href="#" target="_self"
                                                                            class="nav-link"
                                                                            id="__BVID__54___BV_tab_button__"
                                                                            aria-controls="__BVID__54">Раскладка по
                                        складам</a></li>
                                <li role="presentation" class="nav-item"><a role="tab" tabindex="-1"
                                                                            aria-selected="false" aria-setsize="9"
                                                                            aria-posinset="7" href="#" target="_self"
                                                                            class="nav-link"
                                                                            id="__BVID__56___BV_tab_button__"
                                                                            aria-controls="__BVID__56">Ценовая
                                        сегментация</a></li>
                                <li role="presentation" class="nav-item"><a role="tab" tabindex="-1"
                                                                            aria-selected="false" aria-setsize="9"
                                                                            aria-posinset="8" href="#" target="_self"
                                                                            class="nav-link"
                                                                            id="__BVID__58___BV_tab_button__"
                                                                            aria-controls="__BVID__58">Сравнение
                                        периодов</a></li>
                                <li role="presentation" class="nav-item"><a role="tab" tabindex="-1"
                                                                            aria-selected="false" aria-setsize="9"
                                                                            aria-posinset="9" href="#" target="_self"
                                                                            class="nav-link"
                                                                            id="__BVID__60___BV_tab_button__"
                                                                            aria-controls="__BVID__60">Предметы</a></li>
                                <!----></ul>
                        </div>
                        <div class="tab-content" id="__BVID__39__BV_tab_container_">
                            <div role="tabpanel" aria-hidden="false" class="tab-pane active" style="" id="__BVID__40"
                                 aria-labelledby="__BVID__40___BV_tab_button__">
                                <div>
                                    <div class="mb-2 w35">
                                        <div class="ag-theme-balham" style="--ag-line-height:35px;">
                                        </div>
                                        <button class="excel-btn" onclick="option.api.exportDataAsExcel()">
                                            Экспорт
                                            <svg
                                                    viewBox="0 0 16 16"
                                                    width="1em"
                                                    height="1em"
                                                    focusable="false"
                                                    role="img"
                                                    aria-label="file earmark excel"
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    fill="currentColor"
                                                    class="bi-file-earmark-excel b-icon bi"
                                            >
                                                <g>
                                                    <path
                                                            d="M5.884 6.68a.5.5 0 1 0-.768.64L7.349 10l-2.233 2.68a.5.5 0 0 0 .768.64L8 10.781l2.116 2.54a.5.5 0 0 0 .768-.641L8.651 10l2.233-2.68a.5.5 0 0 0-.768-.64L8 9.219l-2.116-2.54z"
                                                    ></path>
                                                    <path
                                                            d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5v2z"
                                                    ></path>
                                                </g>
                                            </svg>
                                        </button>
                                    </div>
                                    <div class="d-flex justify-content-between mt-3">
                                        <div class="d-flex flex-column">
                                            <div class="d-flex align-items-center mb-1">
                                                <div class="row-bg-info mr-1"
                                                     style="background: rgb(66, 133, 244);"></div>
                                                - товар поставляется по FBS
                                            </div>
                                        </div>
                                    </div>
                                    <div role="alert"
                                         class="alert alert-info alert-simple alert-dismissible mt-3 withoutborder">
                                        <div class="icon"><span class=></span></div>
                                        <div class="message"><span>
            Данные о наличии и цене - последние из полученных;<br>
            Изображения товаров транслируются с сайта
            <a href="https://wildberries.ru/">wildberries.ru</a>
            и приведены в информационных целях;<br></span>
                                            Под продажей понимается снижение числа товара, доступного для заказа;<br>
                                            Данные о продажах и выручке рассчитываются за <span>30</span> суток и
                                            заканчиваются вчерашним днем.
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div role="tabpanel" aria-hidden="true" class="tab-pane" style="display: none;"
                                 id="__BVID__46" aria-labelledby="__BVID__46___BV_tab_button__"></div>
                            <div role="tabpanel" aria-hidden="true" class="tab-pane" style="display: none;"
                                 id="__BVID__48" aria-labelledby="__BVID__48___BV_tab_button__"></div>
                            <div role="tabpanel" aria-hidden="true" class="tab-pane" style="display: none;"
                                 id="__BVID__50" aria-labelledby="__BVID__50___BV_tab_button__"></div>
                            <div role="tabpanel" aria-hidden="true" class="tab-pane" style="display: none;"
                                 id="__BVID__52" aria-labelledby="__BVID__52___BV_tab_button__"></div>
                            <div role="tabpanel" aria-hidden="true" class="tab-pane" style="display: none;"
                                 id="__BVID__54" aria-labelledby="__BVID__54___BV_tab_button__"></div>
                            <div role="tabpanel" aria-hidden="true" class="tab-pane" style="display: none;"
                                 id="__BVID__56" aria-labelledby="__BVID__56___BV_tab_button__"></div>
                            <div role="tabpanel" aria-hidden="true" class="tab-pane" style="display: none;"
                                 id="__BVID__58" aria-labelledby="__BVID__58___BV_tab_button__"></div>
                            <div role="tabpanel" aria-hidden="true" class="tab-pane" style="display: none;"
                                 id="__BVID__60" aria-labelledby="__BVID__60___BV_tab_button__"></div><!----></div>
                    </div>
                </div>
            </div>
        </div>
        <div><!---->
            <div class="snotify snotify-left_top"></div>
            <div class="snotify snotify-left_center"></div>
            <div class="snotify snotify-left_bottom"></div>
            <div class="snotify snotify-right_top"></div>
            <div class="snotify snotify-right_center"></div>
            <div class="snotify snotify-right_bottom"></div>
            <div class="snotify snotify-center_top"></div>
            <div class="snotify snotify-center_center"></div>
            <div class="snotify snotify-center_bottom"></div>
        </div>
    </div>
    <script>
        let fbs = {{fbs}}, option = {}
        document.addEventListener("DOMContentLoaded", () => {
            document.getElementById("switcher-element-22404").checked = fbs === 0 ?false:true
            document.getElementById("switcher-element-22404").addEventListener("input", e => {
                    fbs = fbs === 0 ?1:0
                    window.location.href = `{{ path('wb_seller', {sku:sku})}}?date={{d1}} to {{d2}}&fbs=${fbs}`
                }
            )
            newDatePicker('datePicker', function (date) {
                window.location.href = `{{ path('wb_seller', {sku:sku})}}?date=${date}&fbs=${fbs}`
            });
            option = {...getOptions()}

            option['columnDefs'] = [
                {
                    headerName: 'Фото',
                    field: 'thumb',
                    maxWidth: 80,
                    sortable: false,
                    filter: false,
                    cellRenderer: params => `<img style="height: 32px; width: 32px" src="${params.value}" />`
                },
                {
                    headerName: 'SKU',
                    field: 'sku',
                    wrapText: true,
                    autoHeight: true,
                    cellRenderer: params => `<a href="https://www.wildberries.ru/catalog/${params.data.sku}/detail.aspx">${params.value}</a>`
                },
                {
                    headerName: 'Название',
                    field: 'name',
                    wrapText: true,
                    autoHeight: true,
                    cellRenderer: params => `<a href="/wb/item/${params.data.sku}">${params.value}</a>`
                },
                {
                    headerName: 'Цвет',
                    field: 'color',
                    cellRenderer: params => `<a href="/wb/item/${params.data.sku}">${params.value}</a>`
                },
                {
                    headerName: 'Категория',
                    field: 'category',
                    cellRenderer: params => `<a href="/wb/category?url=${params.value}">${params.value}</a>`
                },
                {
                    headerName: 'Позиция',
                    field: 'position',
                    wrapText: true,
                    autoHeight: true,
                },
                {
                    headerName: 'Бренд',
                    field: 'brand',
                    wrapText: true,
                    autoHeight: true,
                    cellRenderer: params => `<a href="/wb/brand/${params.value}">${params.value}</a>`
                },
                {
                    headerName: 'Наличие',
                    field: 'balance',
                    wrapText: true,
                    autoHeight: true,
                },
                {
                    headerName: 'Комментарии',
                    field: 'comments',
                    wrapText: true,
                    autoHeight: true,
                },
                {
                    headerName: 'Рейтинг',
                    field: 'rating',
                    wrapText: true,
                    autoHeight: true,
                },
                {
                    headerName: 'Цена',
                    field: 'final_price',
                    wrapText: true,
                    autoHeight: true,
                    cellRenderer: params => `<p class="number">${params.value}</p>`
                },
                {
                    headerName: 'Цена СПП',
                    field: 'client_price',
                    wrapText: true,
                    autoHeight: true,
                    cellRenderer: params => `<p class="number">${params.value}</p>`
                },
                {
                    headerName: 'Был в наличии',
                    field: 'days_in_stock',
                    wrapText: true,
                    autoHeight: true,
                },
                {
                    headerName: 'Продаж',
                    field: 'sales',
                    wrapText: true,
                    autoHeight: true,
                },
                {
                    headerName: 'Выручка',
                    field: 'revenue',
                    wrapText: true,
                    autoHeight: true,
                    cellRenderer: params => `<p class="number">${params.value}</p>`
                },
            ]
            option['rowData'] = [
                {% for item in data %}
                {
                    thumb: '{{item.thumb}}',
                    sku: '{{item.id}}',
                    name: '{{item.name}}',
                    color: '{{item.color}}',
                    category: '{{item.category}}',
                    position: '{{item.category_position}}',
                    brand: '{{item.brand}}',
                    balance: '{{item.balance}}',
                    comments: '{{item.comments}}',
                    rating: '{{item.rating}}',
                    client_price: '{{item.final_price}} ₽',
                    final_price: '{{item.client_price}} ₽',
                    days_in_stock: '{{item.days_in_stock}}',
                    sales: '{{item.sales}}',
                    revenue: '{{item.revenue}} ₽'
                },
                {% endfor %}
            ]
            new agGrid.Grid(document.getElementsByClassName("ag-theme-balham")[0], option)
        })
        </script>
{% endblock %}